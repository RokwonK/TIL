# 프로세스 동기화

프로세스들 사이에 동기화를 하는 것을 프로세스 동기화  
요즘은 쓰레드 기준으로 context switching하므로 쓰레드 동기화라고도 부른다.  
멀티 쓰레드에서 문제점,  
동일한 자원을 동시에 접근하는 작업을 실행하는 코드 영역을 Critical Section(임계 영역)이라고 한다.  
즉, `공유하는 데이터를 변경하는 코드 영역이다.`

## Critical Section Problem  
프로세스들이 임계 영역을 함께 사용할 수 있는 프로토콜을 설계하는 것이다.  
이 문제를 해결해야 하는 조건이 있다.  
- Mutual exclusion(상호 베타) : 하나의 쓰레드만이 진입 가능하다.
- Progress(진행) : 임계구역에 접근한 쓰레드를 결정하는 것을 유한시간 내에 이루어져야함.  
- Bounded waiting(유한 대기) : 임계구역에 진입하려는 쓰레드들의 대기시간은 유한시간이어야 함.  

<br>

## 해결방법
### **Lock**

하드웨어 기반  
임계구역에 진입하는 프로세스는 Lock을 얻어 진입하고 빠져나올때 Lock을 반납한다.  
시간적인 효율성이 좋지 않음.  

<br>

### **Semaphore(세마포)**  
소프트웨어적인 동기화 도구, 큐 형식이다.  
임계 영역에 접근 시, 카운트를 줄인다.  
카운트가 음수가 아니라면 임계 영역으로 들어가고,  
카운트가 음수라면 이미 다른 프로세스 임계 영역에서 활동중 이라는 뜻.  
queue에 추가해준뒤, 그 프로세스에 block걸어 대기 시킨다.  
임계영역에서 활동 중인 프로세스가 release()시,  
카운트의 수를 확인한다. 카운트 가 0 보다 작다면, 기다리는 프로세스가 있다는 뜻이다.  
큐의 가장 첫 프로세스를 꺼내 block을 풀어 임계영역으로의 접근을 허용한다.  
카운트 == 0 임계영역에서 프로세스가 실행중  
카운트 == 1 아무도 임계영역을 사용하지 않음  
카운트 <  0 어떤 프로세스가 임계영역을 사용하고 있고, 카운트*(-1)개 만큼의 프로세스가 대기중이다.  
 
